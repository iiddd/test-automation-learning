<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Allure Reports Dashboard</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; }
    h1 { font-size: 2rem; margin-bottom: 1rem; }
    h2 { margin-top: 2rem; }
    ul { list-style: none; padding: 0; }
    li { margin: 0.5rem 0; }
    a { color: #0366d6; text-decoration: none; }
    .tag { font-size: 0.8rem; background: #eee; padding: 0.2rem 0.4rem; border-radius: 4px; margin-left: 0.5rem; }
    .footer { margin-top: 2rem; color: #777; font-size: 0.9rem; }
  </style>
</head>
<body>
  <h1>üß™ Allure Reports Dashboard</h1>
  <h2 id="full-title">üìò Full Test Suite Reports</h2>
  <ul id="full-reports">Loading...</ul>
  <h2 id="single-title">üéØ Single Test Reports</h2>
  <ul id="single-reports">Loading...</ul>
  <div class="footer">Auto-generated with ‚ù§Ô∏è using GitHub Pages + JS</div>
  <script>
    async function loadReports(basePath, targetId, titleId) {
      const listEl = document.getElementById(targetId);
      const titleEl = document.getElementById(titleId);
      listEl.innerHTML = "<li>Loading...</li>";

      try {
        const res = await fetch(`${basePath}`);
        const html = await res.text();

        const matches = Array.from(html.matchAll(/href=\"([^\"?/]+)\//g));
        const folders = matches.map(m => m[1])
          .filter(name => name && !name.startsWith('.') && !name.endsWith('.html'));

        const count = folders.length;
        titleEl.innerText += ` (${count} available)`;

        if (count === 0) {
          listEl.innerHTML = '<li><em>No reports found.</em></li>';
          return;
        }

        listEl.innerHTML = '';
        folders.forEach(name => {
          const li = document.createElement('li');
          li.innerHTML = `<a href="${basePath}${name}/index.html" target="_blank">${name}</a> <span class="tag">${name}</span>`;
          listEl.appendChild(li);
        });
      } catch (e) {
        listEl.innerHTML = '<li><em>Error loading reports.</em></li>';
        console.error(e);
      }
    }

    loadReports('all-reports/', 'full-reports', 'full-title');
    loadReports('single-test-reports/', 'single-reports', 'single-title');
  </script>
</body>
</html>
